{
   "apiVersion": "kustomize.toolkit.fluxcd.io/v1beta2",
   "kind": "Kustomization",
   "metadata": {
      "name": "vault-config-operator-patches",
      "namespace": "vault"
   },
   "spec": {
      "patches": [
         {
            "patch": [
               {
                  "op": "add",
                  "path": "/spec/template/spec/volumes",
                  "value": {
                     "name": "vault-tls-certs",
                     "secret": {
                        "secretName": "wildcard-tls-secret"
                     }
                  }
               },
               {
                  "op": "add",
                  "path": "/spec/template/spec/containers/1/volumeMounts",
                  "value": {
                     "mountPath": "/vault-tls",
                     "name": "vault-tls-certs"
                  }
               },
               {
                  "op": "add",
                  "path": "/spec/template/spec/containers/1/env",
                  "value": {
                     "name": "VAULT_CACERT",
                     "value": "/vault-tls/tls.crt"
                  }
               }
            ],
            "target": {
               "kind": "Deployment",
               "labelSelector": "app.kubernetes.io/name=vault-config-operator"
            }
         }
      ],
      "resources": [
         "repo.yaml",
         "release.yaml"
      ]
   }
}
